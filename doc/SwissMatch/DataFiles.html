<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: SwissMatch::DataFiles
  
    &mdash; Documentation by YARD 0.8.2.1
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (D)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../SwissMatch.html" title="SwissMatch (module)">SwissMatch</a></span></span>
     &raquo; 
    <span class="title">DataFiles</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: SwissMatch::DataFiles
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">SwissMatch::DataFiles</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/swissmatch/datafiles.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
  <div class="note todo">
    <strong>TODO:</strong>
    <div class='inline'>
<p>The current handling of the urls is not clean. I don't know yet how the
urls will change over iterations.</p>
</div>
  </div>


<p>Deals with retrieving and updating the files provided by the swiss postal
service, and loading the data from them.</p>


  </div>
</div>
<div class="tags">
  

</div>
  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="Expressions-constant" class="">Expressions =
          <div class="docstring">
  <div class="discussion">
    
<p>Regular expressions used to parse the different files.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span>
  <span class='symbol'>:community</span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_generate_expression'>generate_expression</span><span class='lparen'>(</span><span class='int'>4</span><span class='rparen'>)</span><span class='comma'>,</span>
  <span class='symbol'>:zip_2</span>      <span class='op'>=&gt;</span> <span class='id identifier rubyid_generate_expression'>generate_expression</span><span class='lparen'>(</span><span class='int'>6</span><span class='rparen'>)</span><span class='comma'>,</span>
  <span class='symbol'>:zip_1</span>      <span class='op'>=&gt;</span> <span class='id identifier rubyid_generate_expression'>generate_expression</span><span class='lparen'>(</span><span class='int'>13</span><span class='rparen'>)</span><span class='comma'>,</span>
<span class='rbrace'>}</span></pre></dd>
      
        <dt id="URLZip1-constant" class="">URLZip1 =
          <div class="docstring">
  <div class="discussion">
    
<p>The URL of the plz_p1 file</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>https://match.post.ch/download?file=10001&amp;tid=11&amp;rol=0</span><span class='tstring_end'>&quot;</span></span></pre></dd>
      
        <dt id="URLZip2-constant" class="">URLZip2 =
          <div class="docstring">
  <div class="discussion">
    
<p>The URL of the plz_p2 file</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>https://match.post.ch/download?file=10002&amp;tid=14&amp;rol=0</span><span class='tstring_end'>&quot;</span></span></pre></dd>
      
        <dt id="URLCommunity-constant" class="">URLCommunity =
          <div class="docstring">
  <div class="discussion">
    
<p>The URL of the plz_c file</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>https://match.post.ch/download?file=10003&amp;tid=13&amp;rol=0</span><span class='tstring_end'>&quot;</span></span></pre></dd>
      
        <dt id="URLAll-constant" class="">URLAll =
          <div class="docstring">
  <div class="discussion">
    
<p>An array of all urls</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='lbracket'>[</span><span class='const'>URLZip1</span><span class='comma'>,</span> <span class='const'>URLZip2</span><span class='comma'>,</span> <span class='const'>URLCommunity</span><span class='rbracket'>]</span></pre></dd>
      
        <dt id="CantonData-constant" class="">CantonData =
          <div class="docstring">
  <div class="discussion">
    
<p>The data of all cantons</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='lbracket'>[</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>AG</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Aargau</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Aargau</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Argovie</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Argovia</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Argovia</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>AI</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Appenzell Innerrhoden</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>     <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Appenzell Innerrhoden</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Appenzell Rhodes-Intérieures</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Appenzello Interno</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>       <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Appenzell Dadens</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>AR</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Appenzell Ausserrhoden</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Appenzell Ausserrhoden</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Appenzell Rhodes-Extérieures</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Appenzello Esterno</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>       <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Appenzell Dadora</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>BE</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Bern</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Bern</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                     <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Berne</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Berna</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Berna</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>BL</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Basel-Landschaft</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Basel-Landschaft</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>         <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Bâle-Campagne</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Basilea Campagna</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>         <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Basilea-Champagna</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>BS</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Basel-Stadt</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>               <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Basel-Stadt</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>              <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Bâle-Ville</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Basilea Città</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>            <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Basilea-Citad</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>FR</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Freiburg</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Fribourg</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                 <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Fribourg</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                     <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Friburgo</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                 <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Friburg</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GE</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Genève</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Genf</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                     <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Genève</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                       <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Ginevra</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Genevra</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GL</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Glarus</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Glarus</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Glaris</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                       <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Glarona</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Glaruna</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GR</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Graubünden</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Graubünden</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>               <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Grisons</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Grigioni</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                 <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Grischun</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>JU</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Jura</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Jura</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                     <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Jura</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                         <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Giura</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Giura</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>LU</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Luzern</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Luzern</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Lucerne</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Lucerna</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Lucerna</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>NE</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Neuchâtel</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                 <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Neuenburg</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Neuchâtel</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Neuchâtel</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Neuchâtel</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>NW</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Nidwalden</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                 <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Nidwalden</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Nidwald</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Nidvaldo</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                 <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Sutsilvania</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>OW</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Obwalden</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Obwalden</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                 <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Obwald</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                       <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Obvaldo</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Sursilvania</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SG</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>St. Gallen</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>St. Gallen</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>               <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Saint-Gall</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>San Gallo</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Son Gagl</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SH</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Schaffhausen</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>              <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Schaffhausen</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>             <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Schaffhouse</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Sciaffusa</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Schaffusa</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SO</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Solothurn</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                 <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Solothurn</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Soleure</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Soletta</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Soloturn</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SZ</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Schwyz</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Schwyz</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Schwytz</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Svitto</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Sviz</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>TG</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Thurgau</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Thurgau</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Thurgovie</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Turgovia</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                 <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Turgovia</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>TI</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Ticino</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Tessin</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Tessin</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                       <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Ticino</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Tessin</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>UR</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Uri</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                       <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Uri</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Uri</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Uri</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Uri</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>VD</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Vaud</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Waadt</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Vaud</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                         <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Vaud</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                     <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Vad</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>VS</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Valais</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Wallis</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Valais</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                       <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Vallese</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Vallais</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ZG</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Zug</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                       <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Zug</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Zoug</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                         <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Zugo</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                     <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Zug</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ZH</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Zürich</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Zürich</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Zurich</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                       <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Zurigo</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Turitg</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>FL</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Fürstentum Liechtenstein</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Fürstentum Liechtenstein</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Liechtenstein</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Liechtenstein</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>            <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Liechtenstein</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DE</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Deutschland</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>               <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Deutschland</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>              <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Allemagne</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Germania</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                 <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Germania</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>IT</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Italien</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Italien</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Italie</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                       <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Italia</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Italia</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
<span class='rbracket'>]</span></pre></dd>
      
        <dt id="LanguageCodes-constant" class="">LanguageCodes =
          <div class="docstring">
  <div class="discussion">
    
<p>Used to convert numerical language codes to symbols</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='lbracket'>[</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='symbol'>:de</span><span class='comma'>,</span> <span class='symbol'>:fr</span><span class='comma'>,</span> <span class='symbol'>:it</span><span class='comma'>,</span> <span class='symbol'>:rt</span><span class='rbracket'>]</span></pre></dd>
      
    </dl>
  




  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#cantons-instance_method" title="#cantons (instance method)">- (SwissMatch::Cantons) <strong>cantons</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The loaded swiss cantons.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#communities-instance_method" title="#communities (instance method)">- (SwissMatch::Communities) <strong>communities</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The loaded swiss communities.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#data_directory-instance_method" title="#data_directory (instance method)">- (Object) <strong>data_directory</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The directory in which the post <a href="http://ch">mat</a> files reside.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#errors-instance_method" title="#errors (instance method)">- (Array&lt;LoadError&gt;) <strong>errors</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Errors that occurred while loading the data.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#zip_codes-instance_method" title="#zip_codes (instance method)">- (SwissMatch::ZipCodes) <strong>zip_codes</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The loaded swiss zip codes.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#generate_expression-class_method" title="generate_expression (class method)">+ (Object) <strong>generate_expression</strong>(size) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Used to generate the regular expressions used to parse the data files.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#http_get_zip_file-instance_method" title="#http_get_zip_file (instance method)">- (Array&lt;String&gt;) <strong>http_get_zip_file</strong>(url, destination) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Performs an HTTP-GET for the given url, extracts it as a zipped file into
the destination directory.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (DataFiles) <strong>initialize</strong>(data_directory = nil) </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of DataFiles.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load-instance_method" title="#load (instance method)">- (Array) <strong>load</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns an array of the form [SwissMatch::Cantons, SwissMatch::Communities,
SwissMatch::ZipCodes].</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load%21-instance_method" title="#load! (instance method)">- (self) <strong>load!</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Loads the data into this DataFiles instance.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_cantons-instance_method" title="#load_cantons (instance method)">- (SwissMatch::Cantons) <strong>load_cantons</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A SwissMatch::Cantons containing all cantons used by the swiss postal
service.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_communities-instance_method" title="#load_communities (instance method)">- (SwissMatch::Communities) <strong>load_communities</strong>(cantons) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>An instance of SwissMatch::Communities containing all communities defined
by the files known to this DataFiles instance.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_table-instance_method" title="#load_table (instance method)">- (Array&lt;Array&lt;String&gt;&gt;) <strong>load_table</strong>(path, pattern) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Reads a file and parses using the pattern of the given name.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_updates-instance_method" title="#load_updates (instance method)">- (Array&lt;String&gt;) <strong>load_updates</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Load new files.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_zipcodes-instance_method" title="#load_zipcodes (instance method)">- (SwissMatch::ZipCodes) <strong>load_zipcodes</strong>(cantons, communities) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>TODO: load all files, not just the most recent TODO: calculate valid_until
dates.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reset_errors%21-instance_method" title="#reset_errors! (instance method)">- (self) <strong>reset_errors!</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Resets the list of errors that were encountered during load.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unzip_file-instance_method" title="#unzip_file (instance method)">- (Object) <strong>unzip_file</strong>(file, destination) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Unzips it as a zipped file into the destination directory.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="SwissMatch::DataFiles (class)">DataFiles</a></span></tt>) <strong>initialize</strong>(data_directory = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>A new instance of DataFiles</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>data_directory</span>
      
      
        <span class='type'>(<tt>nil</tt>, <tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The directory in which the post <a href="http://ch">mat</a> files reside</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


102
103
104
105
106
107
108
109
110
111
112
113</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/swissmatch/datafiles.rb', line 102</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_data_directory'>data_directory</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_reset_errors!'>reset_errors!</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_data_directory'>data_directory</span> <span class='kw'>then</span>
    <span class='ivar'>@data_directory</span> <span class='op'>=</span> <span class='id identifier rubyid_data_directory'>data_directory</span>
  <span class='kw'>elsif</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>SWISSMATCH_DATA</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='kw'>then</span>
    <span class='ivar'>@data_directory</span> <span class='op'>=</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>SWISSMATCH_DATA</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_data_directory'>data_directory</span>  <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>../../../data/swissmatch</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='kw'>__FILE__</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_data_directory'>data_directory</span>  <span class='op'>=</span> <span class='const'>Gem</span><span class='period'>.</span><span class='id identifier rubyid_datadir'>datadir</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>swissmatch</span><span class='tstring_end'>'</span></span> <span class='kw'>if</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='const'>Gem</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_directory?'>directory?</span><span class='lparen'>(</span><span class='id identifier rubyid_data_directory'>data_directory</span><span class='rparen'>)</span>
    <span class='ivar'>@data_directory</span> <span class='op'>=</span> <span class='id identifier rubyid_data_directory'>data_directory</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="cantons-instance_method">
  
    - (<tt><span class='object_link'><a href="Cantons.html" title="SwissMatch::Cantons (class)">SwissMatch::Cantons</a></span></tt>) <strong>cantons</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The loaded swiss cantons</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Cantons.html" title="SwissMatch::Cantons (class)">SwissMatch::Cantons</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The loaded swiss cantons</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


89
90
91</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/swissmatch/datafiles.rb', line 89</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cantons'>cantons</span>
  <span class='ivar'>@cantons</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="communities-instance_method">
  
    - (<tt><span class='object_link'><a href="Communities.html" title="SwissMatch::Communities (class)">SwissMatch::Communities</a></span></tt>) <strong>communities</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The loaded swiss communities</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Communities.html" title="SwissMatch::Communities (class)">SwissMatch::Communities</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The loaded swiss communities</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


92
93
94</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/swissmatch/datafiles.rb', line 92</span>

<span class='kw'>def</span> <span class='id identifier rubyid_communities'>communities</span>
  <span class='ivar'>@communities</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="data_directory=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="data_directory-instance_method">
  
    - (<tt>Object</tt>) <strong>data_directory</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The directory in which the post <a href="http://ch">mat</a> files reside</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


86
87
88</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/swissmatch/datafiles.rb', line 86</span>

<span class='kw'>def</span> <span class='id identifier rubyid_data_directory'>data_directory</span>
  <span class='ivar'>@data_directory</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="errors-instance_method">
  
    - (<tt>Array&lt;<span class='object_link'><a href="LoadError.html" title="SwissMatch::LoadError (class)">LoadError</a></span>&gt;</tt>) <strong>errors</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Errors that occurred while loading the data</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="LoadError.html" title="SwissMatch::LoadError (class)">LoadError</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Errors that occurred while loading the data</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


98
99
100</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/swissmatch/datafiles.rb', line 98</span>

<span class='kw'>def</span> <span class='id identifier rubyid_errors'>errors</span>
  <span class='ivar'>@errors</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="zip_codes-instance_method">
  
    - (<tt><span class='object_link'><a href="ZipCodes.html" title="SwissMatch::ZipCodes (class)">SwissMatch::ZipCodes</a></span></tt>) <strong>zip_codes</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The loaded swiss zip codes</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="ZipCodes.html" title="SwissMatch::ZipCodes (class)">SwissMatch::ZipCodes</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The loaded swiss zip codes</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


95
96
97</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/swissmatch/datafiles.rb', line 95</span>

<span class='kw'>def</span> <span class='id identifier rubyid_zip_codes'>zip_codes</span>
  <span class='ivar'>@zip_codes</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="generate_expression-class_method">
  
    + (<tt>Object</tt>) <strong>generate_expression</strong>(size) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Used to generate the regular expressions used to parse the data files.
Generates a regular expression, that matches <tt>size</tt> tab separated
fields, delimited by rn.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


23
24
25</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/swissmatch/datafiles.rb', line 23</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_generate_expression'>generate_expression</span><span class='lparen'>(</span><span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span>
  <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^</span><span class='embexpr_beg'>#{</span><span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>([^\t]*)</span><span class='tstring_end'>'</span></span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>\t</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'>\r\n</span><span class='regexp_end'>/</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="http_get_zip_file-instance_method">
  
    - (<tt>Array&lt;String&gt;</tt>) <strong>http_get_zip_file</strong>(url, destination) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Performs an HTTP-GET for the given url, extracts it as a zipped file into
the destination directory.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>An array with the absolute file paths of the extracted files.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/swissmatch/datafiles.rb', line 137</span>

<span class='kw'>def</span> <span class='id identifier rubyid_http_get_zip_file'>http_get_zip_file</span><span class='lparen'>(</span><span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='id identifier rubyid_destination'>destination</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>open-uri</span><span class='tstring_end'>'</span></span>
  <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>swissmatch/zip</span><span class='tstring_end'>'</span></span> <span class='comment'># patched zip/zip
</span>  <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>fileutils</span><span class='tstring_end'>'</span></span>

  <span class='id identifier rubyid_files'>files</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_url'>url</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_zip_buffer'>zip_buffer</span><span class='op'>|</span>
    <span class='const'>Zip</span><span class='op'>::</span><span class='const'>ZipFile</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_zip_buffer'>zip_buffer</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_zip_file'>zip_file</span><span class='op'>|</span>
      <span class='id identifier rubyid_zip_file'>zip_file</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
        <span class='id identifier rubyid_target_path'>target_path</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_destination'>destination</span><span class='comma'>,</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
        <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_mkdir_p'>mkdir_p</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_dirname'>dirname</span><span class='lparen'>(</span><span class='id identifier rubyid_target_path'>target_path</span><span class='rparen'>)</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_zip_file'>zip_file</span><span class='period'>.</span><span class='id identifier rubyid_extract'>extract</span><span class='lparen'>(</span><span class='id identifier rubyid_f'>f</span><span class='comma'>,</span> <span class='id identifier rubyid_target_path'>target_path</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span><span class='lparen'>(</span><span class='id identifier rubyid_target_path'>target_path</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_files'>files</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_target_path'>target_path</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_files'>files</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load-instance_method">
  
    - (<tt>Array</tt>) <strong>load</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns an array of the form [SwissMatch::Cantons, SwissMatch::Communities,
SwissMatch::ZipCodes].</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns an array of the form [SwissMatch::Cantons, SwissMatch::Communities,
SwissMatch::ZipCodes].</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


185
186
187
188
189
190
191
192
193</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/swissmatch/datafiles.rb', line 185</span>

<span class='kw'>def</span> <span class='id identifier rubyid_load'>load</span>
  <span class='id identifier rubyid_reset_errors!'>reset_errors!</span>

  <span class='id identifier rubyid_cantons'>cantons</span>     <span class='op'>=</span> <span class='id identifier rubyid_load_cantons'>load_cantons</span>
  <span class='id identifier rubyid_communities'>communities</span> <span class='op'>=</span> <span class='id identifier rubyid_load_communities'>load_communities</span><span class='lparen'>(</span><span class='id identifier rubyid_cantons'>cantons</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_zip_codes'>zip_codes</span>   <span class='op'>=</span> <span class='id identifier rubyid_load_zipcodes'>load_zipcodes</span><span class='lparen'>(</span><span class='id identifier rubyid_cantons'>cantons</span><span class='comma'>,</span> <span class='id identifier rubyid_communities'>communities</span><span class='rparen'>)</span>

  <span class='lbracket'>[</span><span class='id identifier rubyid_cantons'>cantons</span><span class='comma'>,</span> <span class='id identifier rubyid_communities'>communities</span><span class='comma'>,</span> <span class='id identifier rubyid_zip_codes'>zip_codes</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load!-instance_method">
  
    - (<tt>self</tt>) <strong>load!</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Loads the data into this DataFiles instance</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>self</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns self.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


177
178
179
180</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/swissmatch/datafiles.rb', line 177</span>

<span class='kw'>def</span> <span class='id identifier rubyid_load!'>load!</span>
  <span class='ivar'>@cantons</span><span class='comma'>,</span> <span class='ivar'>@communities</span><span class='comma'>,</span> <span class='ivar'>@zip_codes</span> <span class='op'>=</span> <span class='op'>*</span><span class='id identifier rubyid_load'>load</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_cantons-instance_method">
  
    - (<tt><span class='object_link'><a href="Cantons.html" title="SwissMatch::Cantons (class)">SwissMatch::Cantons</a></span></tt>) <strong>load_cantons</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>A SwissMatch::Cantons containing all cantons used by the swiss postal
service.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Cantons.html" title="SwissMatch::Cantons (class)">SwissMatch::Cantons</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A SwissMatch::Cantons containing all cantons used by the swiss postal
service.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


197
198
199
200
201
202
203</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/swissmatch/datafiles.rb', line 197</span>

<span class='kw'>def</span> <span class='id identifier rubyid_load_cantons'>load_cantons</span>
  <span class='const'>Cantons</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
    <span class='const'>CantonData</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_name_de'>name_de</span><span class='comma'>,</span> <span class='id identifier rubyid_name_fr'>name_fr</span><span class='comma'>,</span> <span class='id identifier rubyid_name_it'>name_it</span><span class='comma'>,</span> <span class='id identifier rubyid_name_rt'>name_rt</span><span class='op'>|</span>
      <span class='const'>Canton</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_tag'>tag</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_name_de'>name_de</span><span class='comma'>,</span> <span class='id identifier rubyid_name_fr'>name_fr</span><span class='comma'>,</span> <span class='id identifier rubyid_name_it'>name_it</span><span class='comma'>,</span> <span class='id identifier rubyid_name_rt'>name_rt</span><span class='rparen'>)</span>
    <span class='rbrace'>}</span>
  <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_communities-instance_method">
  
    - (<tt><span class='object_link'><a href="Communities.html" title="SwissMatch::Communities (class)">SwissMatch::Communities</a></span></tt>) <strong>load_communities</strong>(cantons) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>An instance of SwissMatch::Communities containing all communities defined
by the files known to this DataFiles instance.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Communities.html" title="SwissMatch::Communities (class)">SwissMatch::Communities</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>An instance of SwissMatch::Communities containing all communities defined
by the files known to this DataFiles instance.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/swissmatch/datafiles.rb', line 208</span>

<span class='kw'>def</span> <span class='id identifier rubyid_load_communities'>load_communities</span><span class='lparen'>(</span><span class='id identifier rubyid_cantons'>cantons</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Must load cantons first</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_cantons'>cantons</span>

  <span class='id identifier rubyid_file'>file</span>      <span class='op'>=</span> <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_enum_for'>enum_for</span><span class='lparen'>(</span><span class='symbol'>:glob</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@data_directory</span><span class='rbrace'>}</span><span class='tstring_content'>/plz_c_*.txt</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
  <span class='id identifier rubyid_temporary'>temporary</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_complete'>complete</span>  <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_load_table'>load_table</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='comma'>,</span> <span class='symbol'>:community</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_bfsnr'>bfsnr</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_canton'>canton</span><span class='comma'>,</span> <span class='id identifier rubyid_agglomeration'>agglomeration</span><span class='op'>|</span>
    <span class='id identifier rubyid_bfsnr'>bfsnr</span>         <span class='op'>=</span> <span class='id identifier rubyid_bfsnr'>bfsnr</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
    <span class='id identifier rubyid_agglomeration'>agglomeration</span> <span class='op'>=</span> <span class='id identifier rubyid_agglomeration'>agglomeration</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
    <span class='id identifier rubyid_canton'>canton</span>        <span class='op'>=</span> <span class='id identifier rubyid_cantons'>cantons</span><span class='period'>.</span><span class='id identifier rubyid_by_license_tag'>by_license_tag</span><span class='lparen'>(</span><span class='id identifier rubyid_canton'>canton</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_agglomeration'>agglomeration</span> <span class='op'>==</span> <span class='id identifier rubyid_bfsnr'>bfsnr</span> <span class='kw'>then</span>
      <span class='id identifier rubyid_complete'>complete</span><span class='lbracket'>[</span><span class='id identifier rubyid_bfsnr'>bfsnr</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>Community</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_bfsnr'>bfsnr</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_canton'>canton</span><span class='comma'>,</span> <span class='symbol'>:self</span><span class='rparen'>)</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_agglomeration'>agglomeration</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='kw'>then</span>
      <span class='id identifier rubyid_complete'>complete</span><span class='lbracket'>[</span><span class='id identifier rubyid_bfsnr'>bfsnr</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>Community</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_bfsnr'>bfsnr</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_canton'>canton</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_temporary'>temporary</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='id identifier rubyid_bfsnr'>bfsnr</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_canton'>canton</span><span class='comma'>,</span> <span class='id identifier rubyid_agglomeration'>agglomeration</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_temporary'>temporary</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_bfsnr'>bfsnr</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_canton'>canton</span><span class='comma'>,</span> <span class='id identifier rubyid_agglomeration'>agglomeration</span><span class='op'>|</span>
    <span class='id identifier rubyid_community'>community</span> <span class='op'>=</span> <span class='id identifier rubyid_complete'>complete</span><span class='lbracket'>[</span><span class='id identifier rubyid_agglomeration'>agglomeration</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Incomplete community referenced by </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_bfsnr'>bfsnr</span><span class='rbrace'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_agglomeration'>agglomeration</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_agglomeration'>agglomeration</span>
    <span class='id identifier rubyid_complete'>complete</span><span class='lbracket'>[</span><span class='id identifier rubyid_bfsnr'>bfsnr</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>Community</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_bfsnr'>bfsnr</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_canton'>canton</span><span class='comma'>,</span> <span class='id identifier rubyid_community'>community</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='const'>Communities</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_complete'>complete</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_table-instance_method">
  
    - (<tt>Array&lt;Array&lt;String&gt;&gt;</tt>) <strong>load_table</strong>(path, pattern) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Reads a file and parses using the pattern of the given name.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The path of the file to parse</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>pattern</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The pattern-name used to parse the file (see Expressions)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;Array&lt;String&gt;&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A 2 dimensional array representing the tabular data contained in the given
file.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


321
322
323
324
325</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/swissmatch/datafiles.rb', line 321</span>

<span class='kw'>def</span> <span class='id identifier rubyid_load_table'>load_table</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_pattern'>pattern</span><span class='rparen'>)</span>
  <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='symbol'>:encoding</span> <span class='op'>=&gt;</span> <span class='const'>Encoding</span><span class='op'>::</span><span class='const'>Windows_1252</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span><span class='period'>.</span> <span class='comment'># to_s because sadly, ruby 1.9.2 can't handle an Encoding instance as argument
</span>    <span class='id identifier rubyid_encode'>encode</span><span class='lparen'>(</span><span class='const'>Encoding</span><span class='op'>::</span><span class='const'>UTF_8</span><span class='rparen'>)</span><span class='period'>.</span>
    <span class='id identifier rubyid_scan'>scan</span><span class='lparen'>(</span><span class='const'>Expressions</span><span class='lbracket'>[</span><span class='id identifier rubyid_pattern'>pattern</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_updates-instance_method">
  
    - (<tt>Array&lt;String&gt;</tt>) <strong>load_updates</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Load new files</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>An array with the absolute file paths of the extracted files.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


126
127
128
129
130</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/swissmatch/datafiles.rb', line 126</span>

<span class='kw'>def</span> <span class='id identifier rubyid_load_updates'>load_updates</span>
  <span class='const'>URLAll</span><span class='period'>.</span><span class='id identifier rubyid_flat_map'>flat_map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_url'>url</span><span class='op'>|</span>
    <span class='id identifier rubyid_http_get_zip_file'>http_get_zip_file</span><span class='lparen'>(</span><span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='ivar'>@data_directory</span><span class='rparen'>)</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_zipcodes-instance_method">
  
    - (<tt><span class='object_link'><a href="ZipCodes.html" title="SwissMatch::ZipCodes (class)">SwissMatch::ZipCodes</a></span></tt>) <strong>load_zipcodes</strong>(cantons, communities) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>TODO: load all files, not just the most recent TODO: calculate valid_until
dates</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="ZipCodes.html" title="SwissMatch::ZipCodes (class)">SwissMatch::ZipCodes</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>An instance of SwissMatch::ZipCodes containing all zip codes defined by the
files known to this DataFiles instance.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/swissmatch/datafiles.rb', line 241</span>

<span class='kw'>def</span> <span class='id identifier rubyid_load_zipcodes'>load_zipcodes</span><span class='lparen'>(</span><span class='id identifier rubyid_cantons'>cantons</span><span class='comma'>,</span> <span class='id identifier rubyid_communities'>communities</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Must load cantons first</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_cantons'>cantons</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Must load communities first</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_communities'>communities</span>

  <span class='id identifier rubyid_temporary'>temporary</span>       <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_self_delivered'>self_delivered</span>  <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_others'>others</span>          <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_zip1_file'>zip1_file</span>       <span class='op'>=</span> <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_enum_for'>enum_for</span><span class='lparen'>(</span><span class='symbol'>:glob</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@data_directory</span><span class='rbrace'>}</span><span class='tstring_content'>/plz_p1_*.txt</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
  <span class='id identifier rubyid_zip2_file'>zip2_file</span>       <span class='op'>=</span> <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_enum_for'>enum_for</span><span class='lparen'>(</span><span class='symbol'>:glob</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@data_directory</span><span class='rbrace'>}</span><span class='tstring_content'>/plz_p2_*.txt</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
  <span class='id identifier rubyid_load_table'>load_table</span><span class='lparen'>(</span><span class='id identifier rubyid_zip1_file'>zip1_file</span><span class='comma'>,</span> <span class='symbol'>:zip_1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span>
    <span class='id identifier rubyid_onrp'>onrp</span>                  <span class='op'>=</span> <span class='id identifier rubyid_row'>row</span><span class='period'>.</span><span class='id identifier rubyid_at'>at</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
    <span class='id identifier rubyid_delivery_by'>delivery_by</span>           <span class='op'>=</span> <span class='id identifier rubyid_row'>row</span><span class='period'>.</span><span class='id identifier rubyid_at'>at</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
    <span class='id identifier rubyid_delivery_by'>delivery_by</span>           <span class='op'>=</span> <span class='kw'>case</span> <span class='id identifier rubyid_delivery_by'>delivery_by</span> <span class='kw'>when</span> <span class='int'>0</span> <span class='kw'>then</span> <span class='kw'>nil</span><span class='semicolon'>;</span> <span class='kw'>when</span> <span class='id identifier rubyid_onrp'>onrp</span> <span class='kw'>then</span> <span class='symbol'>:self</span><span class='semicolon'>;</span> <span class='kw'>else</span> <span class='id identifier rubyid_delivery_by'>delivery_by</span><span class='semicolon'>;</span> <span class='kw'>end</span>
    <span class='id identifier rubyid_language'>language</span>              <span class='op'>=</span> <span class='const'>LanguageCodes</span><span class='lbracket'>[</span><span class='id identifier rubyid_row'>row</span><span class='period'>.</span><span class='id identifier rubyid_at'>at</span><span class='lparen'>(</span><span class='int'>7</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_language_alternative'>language_alternative</span>  <span class='op'>=</span> <span class='const'>LanguageCodes</span><span class='lbracket'>[</span><span class='id identifier rubyid_row'>row</span><span class='period'>.</span><span class='id identifier rubyid_at'>at</span><span class='lparen'>(</span><span class='int'>8</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_name'>name</span>                  <span class='op'>=</span> <span class='const'>Name</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_row'>row</span><span class='period'>.</span><span class='id identifier rubyid_at'>at</span><span class='lparen'>(</span><span class='int'>4</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_language'>language</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_name_short'>name_short</span>            <span class='op'>=</span> <span class='const'>Name</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_row'>row</span><span class='period'>.</span><span class='id identifier rubyid_at'>at</span><span class='lparen'>(</span><span class='int'>5</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_language'>language</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_data'>data</span>                  <span class='op'>=</span> <span class='lbracket'>[</span>
      <span class='id identifier rubyid_onrp'>onrp</span><span class='comma'>,</span>                              <span class='comment'># ordering_number
</span>      <span class='id identifier rubyid_row'>row</span><span class='period'>.</span><span class='id identifier rubyid_at'>at</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='comma'>,</span>                    <span class='comment'># type
</span>      <span class='id identifier rubyid_row'>row</span><span class='period'>.</span><span class='id identifier rubyid_at'>at</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='comma'>,</span>                    <span class='comment'># code
</span>      <span class='id identifier rubyid_row'>row</span><span class='period'>.</span><span class='id identifier rubyid_at'>at</span><span class='lparen'>(</span><span class='int'>3</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='comma'>,</span>                    <span class='comment'># add_on
</span>      <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span>                              <span class='comment'># name (official)
</span>      <span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span><span class='comma'>,</span>                            <span class='comment'># names (official + alternative)
</span>      <span class='id identifier rubyid_name_short'>name_short</span><span class='comma'>,</span>                        <span class='comment'># name_short (official)
</span>      <span class='lbracket'>[</span><span class='id identifier rubyid_name_short'>name_short</span><span class='rbracket'>]</span><span class='comma'>,</span>                      <span class='comment'># names_short (official + alternative)
</span>      <span class='id identifier rubyid_cantons'>cantons</span><span class='period'>.</span><span class='id identifier rubyid_by_license_tag'>by_license_tag</span><span class='lparen'>(</span><span class='id identifier rubyid_row'>row</span><span class='period'>.</span><span class='id identifier rubyid_at'>at</span><span class='lparen'>(</span><span class='int'>6</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='comment'># canton
</span>      <span class='id identifier rubyid_language'>language</span><span class='comma'>,</span>
      <span class='id identifier rubyid_language_alternative'>language_alternative</span><span class='comma'>,</span>
      <span class='id identifier rubyid_row'>row</span><span class='period'>.</span><span class='id identifier rubyid_at'>at</span><span class='lparen'>(</span><span class='int'>9</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                  <span class='comment'># sortfile_member
</span>      <span class='id identifier rubyid_delivery_by'>delivery_by</span><span class='comma'>,</span>                       <span class='comment'># delivery_by
</span>      <span class='id identifier rubyid_communities'>communities</span><span class='period'>.</span><span class='id identifier rubyid_by_community_number'>by_community_number</span><span class='lparen'>(</span><span class='id identifier rubyid_row'>row</span><span class='period'>.</span><span class='id identifier rubyid_at'>at</span><span class='lparen'>(</span><span class='int'>11</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rparen'>)</span><span class='comma'>,</span>  <span class='comment'># community_number
</span>      <span class='const'>Date</span><span class='period'>.</span><span class='id identifier rubyid_civil'>civil</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_row'>row</span><span class='period'>.</span><span class='id identifier rubyid_at'>at</span><span class='lparen'>(</span><span class='int'>12</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^(\d{4})(\d\d)(\d\d)$</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_captures'>captures</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_i</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='comment'># valid_from
</span>    <span class='rbracket'>]</span>
    <span class='id identifier rubyid_temporary'>temporary</span><span class='lbracket'>[</span><span class='id identifier rubyid_onrp'>onrp</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span>
    <span class='kw'>if</span> <span class='symbol'>:self</span> <span class='op'>==</span> <span class='id identifier rubyid_delivery_by'>delivery_by</span> <span class='kw'>then</span>
      <span class='id identifier rubyid_self_delivered'>self_delivered</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_data'>data</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_others'>others</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_data'>data</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_load_table'>load_table</span><span class='lparen'>(</span><span class='id identifier rubyid_zip2_file'>zip2_file</span><span class='comma'>,</span> <span class='symbol'>:zip_2</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_onrp'>onrp</span><span class='comma'>,</span> <span class='id identifier rubyid_rn'>rn</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_lang'>lang</span><span class='comma'>,</span> <span class='id identifier rubyid_short'>short</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_onrp'>onrp</span>      <span class='op'>=</span> <span class='id identifier rubyid_onrp'>onrp</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
    <span class='id identifier rubyid_lang_code'>lang_code</span> <span class='op'>=</span> <span class='id identifier rubyid_lang'>lang</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
    <span class='id identifier rubyid_language'>language</span>  <span class='op'>=</span> <span class='const'>LanguageCodes</span><span class='lbracket'>[</span><span class='id identifier rubyid_lang_code'>lang_code</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_entry'>entry</span>     <span class='op'>=</span> <span class='id identifier rubyid_temporary'>temporary</span><span class='lbracket'>[</span><span class='id identifier rubyid_onrp'>onrp</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_entry'>entry</span><span class='lbracket'>[</span><span class='int'>5</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='const'>Name</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_language'>language</span><span class='comma'>,</span> <span class='id identifier rubyid_rn'>rn</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_entry'>entry</span><span class='lbracket'>[</span><span class='int'>7</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='const'>Name</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_short'>short</span><span class='comma'>,</span> <span class='id identifier rubyid_language'>language</span><span class='comma'>,</span> <span class='id identifier rubyid_rn'>rn</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_self_delivered'>self_delivered</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span>
    <span class='id identifier rubyid_temporary'>temporary</span><span class='lbracket'>[</span><span class='id identifier rubyid_row'>row</span><span class='period'>.</span><span class='id identifier rubyid_at'>at</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>ZipCode</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_row'>row</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_others'>others</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_row'>row</span><span class='period'>.</span><span class='id identifier rubyid_at'>at</span><span class='lparen'>(</span><span class='int'>12</span><span class='rparen'>)</span> <span class='kw'>then</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Delivery not found:\n</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_row'>row</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_tmp'>tmp</span> <span class='op'>=</span> <span class='id identifier rubyid_temporary'>temporary</span><span class='lbracket'>[</span><span class='id identifier rubyid_row'>row</span><span class='period'>.</span><span class='id identifier rubyid_at'>at</span><span class='lparen'>(</span><span class='int'>12</span><span class='rparen'>)</span><span class='rbracket'>]</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_tmp'>tmp</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span> <span class='kw'>then</span>
        <span class='ivar'>@errors</span> <span class='op'>&lt;&lt;</span> <span class='const'>LoadError</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid reference: onrp </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_row'>row</span><span class='period'>.</span><span class='id identifier rubyid_at'>at</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'> delivery by </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_row'>row</span><span class='period'>.</span><span class='id identifier rubyid_at'>at</span><span class='lparen'>(</span><span class='int'>12</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_row'>row</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='int'>12</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>nil</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='int'>12</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp'>tmp</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_temporary'>temporary</span><span class='lbracket'>[</span><span class='id identifier rubyid_row'>row</span><span class='period'>.</span><span class='id identifier rubyid_at'>at</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>ZipCode</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_row'>row</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='const'>ZipCodes</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_temporary'>temporary</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reset_errors!-instance_method">
  
    - (<tt>self</tt>) <strong>reset_errors!</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Resets the list of errors that were encountered during load</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>self</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


117
118
119
120</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/swissmatch/datafiles.rb', line 117</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reset_errors!'>reset_errors!</span>
  <span class='ivar'>@errors</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unzip_file-instance_method">
  
    - (<tt>Object</tt>) <strong>unzip_file</strong>(file, destination) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Unzips it as a zipped file into the destination directory.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


159
160
161
162
163
164
165
166
167
168</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/swissmatch/datafiles.rb', line 159</span>

<span class='kw'>def</span> <span class='id identifier rubyid_unzip_file'>unzip_file</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='comma'>,</span> <span class='id identifier rubyid_destination'>destination</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>swissmatch/zip</span><span class='tstring_end'>'</span></span>
  <span class='const'>Zip</span><span class='op'>::</span><span class='const'>ZipFile</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_zip_file'>zip_file</span><span class='op'>|</span>
    <span class='id identifier rubyid_zip_file'>zip_file</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
      <span class='id identifier rubyid_target_path'>target_path</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_destination'>destination</span><span class='comma'>,</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
      <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_mkdir_p'>mkdir_p</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_dirname'>dirname</span><span class='lparen'>(</span><span class='id identifier rubyid_target_path'>target_path</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_zip_file'>zip_file</span><span class='period'>.</span><span class='id identifier rubyid_extract'>extract</span><span class='lparen'>(</span><span class='id identifier rubyid_f'>f</span><span class='comma'>,</span> <span class='id identifier rubyid_target_path'>target_path</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span><span class='lparen'>(</span><span class='id identifier rubyid_target_path'>target_path</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Wed Aug  8 00:53:25 2012 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.2.1 (ruby-1.9.3).
</div>

  </body>
</html>